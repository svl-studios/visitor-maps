!function(o){"use strict";o.visitorMaps=o.visitorMaps||{},o.visitorMaps.ajax=o.visitorMaps.ajax||{},o(document).ready(function(){o.visitorMaps.ajax.geoLiteCityUpdate(o(this)),o.visitorMaps.ajax.runLookupTest()}),o.visitorMaps.ajax.runLookupTest=function(){o(".geolitecity-lookup").on("click",function(e){var a=o(this).parent().parent(),s=a.attr("data-nonce");return a.removeClass("updated-message").addClass("updating-message"),a.find("p").html(visitorMaps.update_notice.enable+'<span class="lookup-data"></span>'),o.ajax({type:"post",dataType:"html",url:visitorMapsAjax.ajaxurl,data:{action:"visitor_maps_lookup",nonce:s},error:function(e){console.log(e),a.removeClass("updating-message notice-success").addClass("update-message notice-error"),a.find("p").html(visitorMapsAjax.update_geolitecity.lookup_fail)},success:function(e){a.removeClass("updating-message").addClass("updated-message"),a.find(".lookup-data").html(e),console.log(e)}}),e.preventDefault(),!1})},o.visitorMaps.ajax.geoLiteCityUpdate=function(i){i.find(".update-geolitecity").on("click",function(e){var a=o(this).parent().parent(),s=a.data("nonce"),t=Boolean(a.data("update"));return e.preventDefault(),a.find("p").text(visitorMapsAjax.update_geolitecity.updating),a.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),o.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:"visitor_maps_geolitecity",nonce:s,update:t},error:function(e){console.log(e),a.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),a.find("p").html(visitorMapsAjax.update_geolitecity.error),o.visitorMaps.ajax.geoLiteCityUpdate(i)},success:function(e){console.log(e),"success"===e.status?(a.find("p").html(visitorMapsAjax.update_geolitecity.success+'<span class="lookup-data"></span>'),a.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),o(".visitor-maps-geolitecity").not(".notice-success").remove(),t&&a.data("update",!1),o.visitorMaps.ajax.runLookupTest(),0<(e=a.parent().find(".geolocation-warn")).length&&e.remove(),0<(e=a.parent().next().find("tr.location-enable")).length&&e.hasClass("hidden")&&(e.removeClass("hidden"),0<(e=e.find("fieldset.hidden")).length&&e.removeClass("hidden"))):(a.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),a.find("p").html(visitorMapsAjax.update_geolitecity.error),o.visitorMaps.ajax.geoLiteCityUpdate(i))}}),!1})}}(jQuery);